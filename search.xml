<?xml version="1.0" encoding="utf-8"?>
<search>
  
    
    <entry>
      <title><![CDATA[DockeråˆæŽ¢]]></title>
      <url>%2F2017%2F07%2F17%2FDocker-Start-Up-1%2F</url>
      <content type="text"><![CDATA[ä½¿ç”¨ docker-machine &amp; ä½¿ç”¨é˜¿é‡Œäº‘åŠ é€Ÿå›½å†… docker hub è®¿é—®é€Ÿåº¦ Docker Hub é•œåƒç«™ç‚¹ æ“ä½œæ–‡æ¡£ å¼€å¯ç»ˆç«¯è‡ªåŠ¨ä½¿ç”¨ docker-machine .bash_profile æ·»åŠ  1eval $(docker-machine env default) å¼€å¯å¯åŠ¨ docker-machine 1cd ~/Library/LaunchAgents åˆ›å»º com.docker.machine.default.plist æ–‡ä»¶,æ·»åŠ å¦‚ä¸‹å†…å®¹: 123456789101112131415161718192021&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;&lt;plist version=&quot;1.0&quot;&gt; &lt;dict&gt; &lt;key&gt;EnvironmentVariables&lt;/key&gt; &lt;dict&gt; &lt;key&gt;PATH&lt;/key&gt; &lt;string&gt;/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin&lt;/string&gt; &lt;/dict&gt; &lt;key&gt;Label&lt;/key&gt; &lt;string&gt;com.docker.machine.default&lt;/string&gt; &lt;key&gt;ProgramArguments&lt;/key&gt; &lt;array&gt; &lt;string&gt;/usr/local/bin/docker-machine&lt;/string&gt; &lt;string&gt;start&lt;/string&gt; &lt;string&gt;default&lt;/string&gt; &lt;/array&gt; &lt;key&gt;RunAtLoad&lt;/key&gt; &lt;true/&gt; &lt;/dict&gt;&lt;/plist&gt; Mac ä¸‹ä½¿ç”¨ docker-machine ï¼Œæœ¬æœºæ— æ³•è®¿é—® docker machine å†… docker å®¹å™¨é—®é¢˜è§£å†³ 1sudo route add 172.17.0.0/16 $(docker-machine ip &lt;default&gt;) via: https://github.com/moby/moby/issues/19119]]></content>
    </entry>

    
    <entry>
      <title><![CDATA[Nettyç”¨æˆ·æŒ‡å—4.x]]></title>
      <url>%2F2017%2F03%2F27%2FUser-guide-for-4-x-CN%2F</url>
      <content type="text"><![CDATA[Netty ç”¨æˆ·æŒ‡å—ä¸­æ–‡ç‰ˆ Based on User guide for 4.x . åºè¨€ Preface é—®é¢˜ The Problem å¦‚ä»Šæˆ‘ä»¬ä½¿ç”¨é€šç”¨çš„åº”ç”¨ç¨‹åºæˆ–è€…åº“æ¥å½¼æ­¤é€šè®¯ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨ HTTP å®¢æˆ·ç«¯åº“ä»Žè¿œç¨‹æœåŠ¡å™¨æŽ¥æ”¶ä¿¡æ¯æˆ–è€…æ‰§è¡Œè¿œç¨‹æœåŠ¡çš„è°ƒç”¨ã€‚ä½†æ— è®ºå¦‚ä½•ï¼Œä¸€ä¸ªé€šç”¨çš„åè®®æˆ–è€…å®ƒä»¬çš„å®žçŽ°æœ‰æ—¶å€™å¯ç”¨æ€§ä¸æ˜¯å¤ªå¥½ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸ä½¿ç”¨é€šç”¨çš„ HTTP åè®®æ¥äº¤æ¢å¤§æ•°æ®ã€ç”µå­é‚®ä»¶ä¿¡æ¯ä»¥åŠé‡‘èžæ•°æ®å’Œå¤šäººç½‘ç»œæ¸¸æˆæ•°æ®è¿™ç§è¿‘å®žæ—¶çš„æ•°æ®ã€‚æ‰€éœ€è¦çš„æ˜¯ä¸ºäº†ä¸€ä¸ªä¸“é—¨çš„ç›®çš„åŽ»å®žçŽ°ä¸€ä¸ªé«˜åº¦ä¼˜åŒ–çš„åè®®ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½éœ€ä¸ºäº†åŸºäºŽ AJAX çš„èŠå¤©åº”ç”¨ï¼Œåª’ä½“ä¼ è¾“ï¼Œæˆ–è€…å¤§æ–‡ä»¶ä¼ è¾“åŽ»å®žçŽ°ä¸€ä¸ªä¼˜åŒ–çš„ HTTP æœåŠ¡ã€‚ä½ ç”šè‡³å¯ä»¥ä¸ºäº†ä½ çš„éœ€æ±‚åŽ»ç²¾ç¡®çš„å®šä¹‰å¹¶å®žçŽ°ä¸€ä¸ªå…¨æ–°çš„åè®®ã€‚å¦å¤–ä¸€ä¸ªç»å¸¸å‘ç”Ÿçš„æƒ…å†µæ˜¯ä½ å¿…é¡»åŽ»å¤„ç†ç³»ç»Ÿä¸­é—ç•™çš„ä¸“é—¨åè®®åŽ»ç¡®ä¿ä¸Žæ—§ç³»ç»Ÿçš„äº¤äº’ã€‚è¿™ç§æƒ…å†µä¸‹é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•èƒ½å¤Ÿå¿«é€Ÿçš„å®žçŽ°è¯¥åè®®ï¼Œå¹¶ä¸”ä¸ä¼šç‰ºç‰²åº”ç”¨ç¨‹åºçš„ç¨³å®šæ€§å’Œæ€§èƒ½ã€‚ è§£å†³æ–¹æ¡ˆ The Solution Netty æ˜¯ä¸€ä¸ªæä¾›äº†å¼‚æ­¥äº‹ä»¶é©±åŠ¨ (asynchronous event-driven) ç½‘ç»œåº”ç”¨ç¨‹åºæ¡†æž¶å’Œå·¥å…·çš„æ°ä½œï¼Œå¯ä»¥ç”¨æ¥å¿«é€Ÿå¼€å‘å¯ç»´æŠ¤çš„ï¼Œé«˜æ€§èƒ½ Â· é«˜å¯ç”¨çš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åè®®ã€‚ ä»Žå¦ä¸€æ–¹é¢æ¥è®²ï¼ŒNetty æ˜¯ä¸€ä¸ªå¯ä»¥å¿«é€Ÿå¼€å‘ç½‘ç»œç¨‹åºï¼Œå¦‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åè®®çš„ NIO å®¢æˆ·ç«¯/æœåŠ¡ç«¯æ¡†æž¶ã€‚å®ƒå¤§å¤§çš„ç®€åŒ–äº†å¦‚ TCP å’Œ UDP è¿™ç±»å¥—æŽ¥å­—æœåŠ¡çš„ç½‘ç»œåº”ç”¨ç¨‹åºçš„å¼€å‘å¹¶ä¼˜åŒ–äº†å…¶å¼€å‘æµç¨‹ã€‚ â€œå¿«é€Ÿç®€å•â€å¹¶ä¸æ„å‘³ç€å¼€å‘å‡ºçš„åº”ç”¨ç¨‹åºçš„å¯ç»´æŠ¤æ€§å˜å·®æˆ–è€…é‡åˆ°æ€§èƒ½é—®é¢˜ã€‚ Netty ä»Žå¤§é‡çš„å¦‚ FTPã€SMPTã€HTTP ä»¥åŠå„ç§äºŒè¿›åˆ¶æ–‡æœ¬ä¼ è¾“åè®®çš„å®žçŽ°ä¸­èŽ·å¾—ç»éªŒï¼Œå¹¶ç²¾å¿ƒè®¾è®¡ã€‚å› æ­¤ï¼Œ Netty æˆåŠŸçš„èŽ·å¾—äº†å¯ä»¥å¿«é€Ÿå¼€å‘ï¼Œå¹¶ä¸”ä¸å¦¥åæ€§èƒ½ã€ç¨³å®šæ€§ä»¥åŠçµæ´»æ€§çš„æ–¹æ³•ã€‚ ä¸€äº›ç”¨æˆ·ç”¨æˆ·æˆ–è€…å‘çŽ°è¿‡å…¶ä»–ä¸€äº›ç½‘ç»œåº”ç”¨æ¡†æž¶ä¹Ÿå£°ç§°æœ‰ä»¥ä¸Šä¼˜åŠ¿ï¼Œå¯èƒ½ä¼šæƒ³é—® Netty å’Œå®ƒä»¬æœ‰ä½•ä¸åŒã€‚ç­”æ¡ˆæ˜¯ï¼Œè®¾è®¡å“²å­¦ã€‚ Netty ä»Žä¸€å¼€å§‹å°±è®¾è®¡å¾—ä¸ºä½ æä¾›èˆ’é€‚çš„ API åŠå®žçŽ°ã€‚è¿™è™½éžä»€ä¹ˆå¯æ„ŸçŸ¥çš„äº‹ç‰©ï¼Œä½†ä½ ä¼šæ„è¯†åˆ°è¿™äº›è®¾è®¡å“²å­¦è®©ä½ çš„ç”Ÿæ´»å˜å¾—æ›´ç®€å•ï¼Œå¦‚åŒä½ å¼€å§‹é˜…è¯»è¿™ä»½æŒ‡å—ï¼Œå¹¶ä¸”å¼€å§‹è½»æ¾ä½¿ç”¨ Netty ã€‚ å¼€å§‹ Getting Started æœ¬ç« æŒ‡å—å›´ç»•ç€ Netty çš„æ ¸å¿ƒç»“æž„ï¼Œæ®ä¸€äº›ç®€å•çš„ä¾‹å­ï¼Œè®©ä½ è½»æ¾å¼€å§‹ã€‚æœ¬ç« ç»“æŸåŽï¼Œä½ å°†å¯åœ¨ Netty ä¹‹ä¸Šç¼–å†™å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ã€‚ å¦‚æžœä½ å­¦ä¹ ä¸œè¥¿çš„æ—¶å€™å–œæ¬¢ä½¿ç”¨è‡ªä¸Šè€Œä¸‹åˆ†æžæ³•ï¼Œé‚£ä¹ˆä½ ä¹Ÿè®¸å¯ä»¥ä»Žç¬¬äºŒç« ï¼Œæž¶æž„æ€»è§ˆå¼€å§‹ï¼Œç„¶åŽå›žåˆ°è¿™é‡Œã€‚ å¼€å§‹ä¹‹å‰ Before Getting Started è¦æƒ³è¿è¡Œæœ¬ç« ä¸­æ‰€å¼•å…¥çš„ä¾‹å­ï¼Œéœ€è¦ä¸¤ä¸ªæœ€å°çš„ä¾èµ–ï¼šNetty æœ€æ–°çš„ç¨³å®šç‰ˆ å’Œ JDK 1.6 æˆ–è€…æ›´æ–°ã€‚Netty æœ€æ–°çš„ç¨³å®šç‰ˆå¯ä»¥ä»Ž é¡¹ç›®ä¸‹è½½é¡µé¢ ä¸‹è½½ã€‚å¯ä»¥ä»Ž JDK ä¾›åº”å•†çš„ç½‘ç«™ä¸‹è½½æ­£ç¡®ç‰ˆæœ¬çš„ JDK ã€‚ åœ¨ä½ é˜…è¯»çš„è¿‡ç¨‹ä¸­ï¼Œä½ å¯èƒ½å¯¹æœ¬ç« ä¸­å¼•å…¥çš„ç±»æœ‰ä¸€äº›ç–‘é—®ã€‚å¦‚æžœä½ æƒ³çŸ¥é“å®ƒä»¬å¯ä»¥å‚è€ƒ API æ–‡æ¡£ã€‚ä¸ºäº†ä½ çš„æ–¹ä¾¿ï¼Œæ–‡æ¡£ä¸­æ‰€æœ‰çš„ç±»åéƒ½æ˜¯å¼•ç”¨çš„åœ¨çº¿ API æ–‡æ¡£ã€‚å½“ç„¶äº†ï¼Œå¦‚æžœæœ¬æ–‡æ¡£ä¸­æœ‰ä»»ä½•é”™è¯¯ä¿¡æ¯ï¼Œä»¥åŠè¯­æ³•å’Œæ‰“å°ä¸­çš„é”™è¯¯ï¼Œæˆ–è€…ä½ æœ‰ä»€ä¹ˆå®Œå–„æœ¬æ–‡æ¡£çš„å¥½çš„å»ºè®®ï¼Œå¯ä»¥è”ç³»Nettyé¡¹ç›®ç¤¾åŒºã€‚ å†™ä¸€ä¸ª Discard æœåŠ¡ Writing a Discard Server ä¸–ç•Œä¸Šæœ€ç®€å•çš„åè®®æ˜¯ DISCARD ï¼Œè€Œä¸æ˜¯ â€œHello,World!â€ã€‚è¯¥åè®®ä¸¢å¼ƒä»»ä½•æ”¶åˆ°çš„æ•°æ®è€Œä¸åšä»»ä½•å›žåº”ã€‚ è¦å®žçŽ° DISCARD åè®®ï¼Œä½ å”¯ä¸€è¦åšçš„äº‹æƒ…å°±æ˜¯å¿½ç•¥ä»»ä½•æ”¶åˆ°çš„æ¶ˆæ¯ã€‚è®©æˆ‘ä»¬ç›´æŽ¥ä»Žä¸€ä¸ª handler çš„å®žçŽ°å¼€å§‹ï¼Œhandler æ˜¯ Netty ç”Ÿæˆçš„ç”¨æ¥å¤„ç† I/O äº‹ä»¶çš„ã€‚ 12345678910111213141516171819202122232425package io.netty.example.discard;import io.netty.buffer.ByteBuf;import io.netty.channel.ChannelHandlerContext;import io.netty.channel.ChannelInboundHandlerAdapter;/** * å¤„ç†ä¸€ä¸ªæœåŠ¡ç«¯çš„ channelã€‚ */public class DiscardServerHandler extends ChannelInboundHandlerAdapter &#123; // (1) @Override public void channelRead(ChannelHandlerContext ctx, Object msg) &#123; // (2) // é»˜é»˜çš„ä¸¢å¼ƒæ”¶åˆ°çš„æ•°æ®ã€‚ ((ByteBuf) msg).release(); // (3) &#125; @Override public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) &#123; // (4) // å½“å¼•å‘å¼‚å¸¸æ—¶å…³é—­è¿žæŽ¥ã€‚ cause.printStackTrace(); ctx.close(); &#125;&#125; DiscardServerHandler ç»§æ‰¿è‡ª ChannelInboundHandlerAdapterï¼Œè¯¥ç±»å®žçŽ°äº† ChannelInboundHandler .ChannelInboundHandler æŽ¥å£ï¼Œæä¾›äº†å¤šç§äº‹ä»¶å¤„ç†æ–¹æ³•ï¼Œä½ å¯ä»¥é‡å†™è¿™äº›æ–¹æ³•ã€‚çŽ°åœ¨ï¼Œä½ åªéœ€è¦ç»§æ‰¿ ChannelInboundHandlerAdapter ,è€Œæ— éœ€è‡ªå·±å®žçŽ°æŽ¥å£ä¸­çš„å¤„ç†æ–¹æ³•ã€‚ æˆ‘ä»¬é‡å†™äº† channelRead() æ–¹æ³•ã€‚æ— è®ºä½•æ—¶ä»Žå®¢æˆ·ç«¯æ”¶åˆ°æ¶ˆæ¯æ—¶ï¼Œè¯¥æ–¹æ³•è¢«è°ƒç”¨ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ”¶åˆ°çš„æ¶ˆæ¯ç±»åž‹æ˜¯ ByteBuf ä¸ºäº†å®žçŽ° DISCARD åè®®ï¼Œè¯¥å¤„ç†å™¨å¿…é¡»å¿½ç•¥æ”¶åˆ°çš„æ¶ˆæ¯ã€‚ ByteBuf æ˜¯ä¸€ä¸ªå¼•ç”¨è®¡æ•°å¯¹è±¡ï¼Œæ‰€ä»¥å¿…é¡»æ˜¾å¼çš„è°ƒç”¨ release() æ–¹æ³•æ¥é‡Šæ”¾èµ„æºã€‚è¯·è°¨è®°ï¼Œä»»ä½•ä¼ é€’åˆ°å¤„ç†å™¨å¼•ç”¨è®¡æ•°å¯¹è±¡ï¼Œå¤„ç†å™¨éƒ½æœ‰è´£ä»»å°†å…¶é‡Šæ”¾æŽ‰ã€‚é€šå¸¸ï¼Œ channelRead() æ–¹æ³•çš„å®žçŽ°å¦‚ä¸‹ï¼š 12345678@Overridepublic void channelRead(ChannelHandlerContext ctx, Object msg) &#123; try &#123; // Do something with msg &#125; finally &#123; ReferenceCountUtil.release(msg); &#125;&#125; å½“ Netty çŠ¹è±« I/O é”™è¯¯æˆ–è€…å¤„ç†å™¨å¤„ç†äº‹ä»¶æ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œå¯¼è‡´ Throwable å¯¹è±¡å‡ºçŽ°æ—¶ï¼ŒexceptionCaught() æ–¹æ³•è¢«è°ƒç”¨ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¡¥è´§åˆ°çš„å¼‚å¸¸åº”è¯¥è¢«è®°å½•ï¼Œä¸Žå…¶ç›¸å…³çš„ channle ä¹Ÿåº”è¯¥åœ¨è¿™å„¿è¢«å…³é—­ï¼Œå½“ç„¶äº†ï¼Œè¯¥æ–¹æ³•çš„å®žçŽ°ä¹Ÿä¼šå› ä½ çš„ä¸åŒå¼‚å¸¸å¤„ç†æ–¹æ¡ˆè€Œä¸åŒã€‚æ¯”å¦‚ï¼Œä½ ä¹Ÿè®¸æƒ³åœ¨å…³é—­è¿žæŽ¥ä¹‹å‰å‘é€ä¸€ä¸ªåŒ…å«é”™è¯¯ä»£ç çš„å“åº”æ¶ˆæ¯ã€‚ ç›®å‰æ¥è¯´ä¸€åˆ‡éƒ½å¾ˆå¥½ï¼Œæˆ‘ä»¬å®žçŽ°äº†ä¸€åŠçš„ DISCARD æœåŠ¡ã€‚çŽ°åœ¨å‰©ä¸‹æˆ‘ä»¬åŽ»åœ¨ DiscardServerHandler ä¸­å†™ä¸€ä¸ª main() æ–¹æ³•æ¥å¯åŠ¨æœåŠ¡ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061package io.netty.example.discard;import io.netty.bootstrap.ServerBootstrap;import io.netty.channel.ChannelFuture;import io.netty.channel.ChannelInitializer;import io.netty.channel.ChannelOption;import io.netty.channel.EventLoopGroup;import io.netty.channel.nio.NioEventLoopGroup;import io.netty.channel.socket.SocketChannel;import io.netty.channel.socket.nio.NioServerSocketChannel;/** * ä¸¢å¼ƒä»»ä½•è¿›æ¥çš„æ•°æ®ã€‚ */public class DiscardServer &#123; private int port; public DiscardServer(int port) &#123; this.port = port; &#125; public void run() throws Exception &#123; EventLoopGroup bossGroup = new NioEventLoopGroup(); // (1) EventLoopGroup workerGroup = new NioEventLoopGroup(); try &#123; ServerBootstrap b = new ServerBootstrap(); // (2) b.group(bossGroup, workerGroup) .channel(NioServerSocketChannel.class) // (3) .childHandler(new ChannelInitializer&lt;SocketChannel&gt;() &#123; // (4) @Override public void initChannel(SocketChannel ch) throws Exception &#123; ch.pipeline().addLast(new DiscardServerHandler()); &#125; &#125;) .option(ChannelOption.SO_BACKLOG, 128) // (5) .childOption(ChannelOption.SO_KEEPALIVE, true); // (6) // ç»‘å®šç«¯å£å¹¶ä¸”å¼€å§‹æœåŠ¡æŽ¥æ”¶è¿›æ¥çš„è¿žæŽ¥ã€‚ ChannelFuture f = b.bind(port).sync(); // (7) // ç­‰å¾… server socket å…³é—­ã€‚ // åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™ä¸ä¼šå‘ç”Ÿï¼Œä½†ä½ å¯ä»¥è¿™æ ·ä¼˜é›…çš„å…³é—­ä½ çš„æœåŠ¡ã€‚ f.channel().closeFuture().sync(); &#125; finally &#123; workerGroup.shutdownGracefully(); bossGroup.shutdownGracefully(); &#125; &#125; public static void main(String[] args) throws Exception &#123; int port; if (args.length &gt; 0) &#123; port = Integer.parseInt(args[0]); &#125; else &#123; port = 8080; &#125; new DiscardServer(port).run(); &#125;&#125; NioEventLoopGroup æ˜¯ä¸€ä¸ªç”¨æ¥å¤„ç† I/O æ“ä½œçš„å¤šçº¿ç¨‹äº‹ä»¶å¾ªçŽ¯å™¨ã€‚ Netty ä¸ºä¸åŒç±»åž‹ä¼ è¾“æä¾›äº†å„ç§å„æ ·çš„ EventLoopGroup çš„å®žçŽ°ã€‚è¿™ä¸ªä¾‹å­æˆ‘ä»¬å®žçŽ°äº†ä¸€ä¸ªæœåŠ¡ç«¯çš„åº”ç”¨ï¼Œå£°æ˜Žäº†ä¸¤ä¸ª NioEventLoopGroup å®žä¾‹ã€‚ç¬¬ä¸€ä¸ªï¼Œé€šå¸¸ç§°ä¸º â€œbossâ€,ç”¨æ¥æŽ¥æ”¶è¿›æ¥çš„è¿žæŽ¥ã€‚ç¬¬äºŒä¸ªï¼Œé€šå¸¸ç§°ä¸º â€œworkerâ€, ç”¨æ¥å¤„ç†æŽ¥æ”¶åˆ°è¿žæŽ¥ï¼Œä¸€æ—¦ boss æŽ¥æ”¶åˆ°è¿žæŽ¥ï¼Œå°±å°†å…¶æ³¨å†Œåˆ° worker ä¸Šã€‚ä½¿ç”¨å¤šå°‘ä¸ªçº¿ç¨‹ï¼Œå¦‚ä½•å°†å…¶æ˜ å°„åˆ°å·²ç»åˆ›å»ºå¥½çš„ channelS ä¾èµ–äºŽ EventLoopGroup çš„å®žçŽ°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æž„é€ æ–¹æ³•è¿›è¡Œé…ç½®ã€‚ ServerBootstrap æ˜¯ä¸€ä¸ªå»ºç«‹ server çš„è¾…åŠ©ç±»ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡ Channel ç›´æŽ¥å»ºç«‹ä¸€ä¸ª serverã€‚ä½†è¯·æ³¨æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªéžå¸¸å†—é•¿çš„è¿‡ç¨‹ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œä½ å¹¶ä¸éœ€è¦è¿™ä¹ˆåšã€‚ åœ¨è¿™å„¿ï¼Œæˆ‘ä»¬æŒ‡å®šä½¿ç”¨ NioServerSocketChannel ç±»æ¥å®žä¾‹åŒ–ä¸€ä¸ªæ–°çš„ Channel æ¥æŽ¥æ”¶è¿›æ¥çš„è¿žæŽ¥ã€‚ åœ¨è¿™å„¿æŒ‡å®šçš„å¤„ç†å™¨é€šå¸¸ç”±æ–°æŽ¥æ”¶çš„ Channel è¿›è¡Œè¯„ä¼°ã€‚ChannelInitializer æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¤„ç†å™¨ï¼Œç”¨æ¥å¸®åŠ©ç”¨æˆ·é…ç½®ä¸€ä¸ªæ–°çš„ Channelã€‚å¾ˆå¯èƒ½ä½ ä¼šæƒ³é€šè¿‡æ·»åŠ å¤„ç†å™¨,å¦‚ DiscardServerHandler ,æ¥é…ç½®æ–° Channel çš„ ChannelPipeline ,ç”¨æ¥å®žçŽ°ä½ çš„ç½‘ç»œåº”ç”¨ã€‚éšç€åº”ç”¨å˜å¾—å¤æ‚ï¼Œä½ ä¼šå¾€ç®¡é“æ·»åŠ æ›´å¤šçš„å¤„ç†å™¨ï¼Œæœ€ç»ˆä½ å¯èƒ½ä¼šæŠŠè¿™ä¸ªåŒ¿åç±»æå–ä¸ºä¸€ä¸ªå•ç‹¬çš„ç±»ã€‚ ä½ å¯ä»¥è®¾ç½®æŒ‡å®š Channel å®žçŽ°çš„ç‰¹å®šå‚æ•°ã€‚æˆ‘ä»¬åœ¨å†™ä¸€ä¸ª TCP/IP æœåŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€äº› socket çš„é€‰é¡¹ï¼Œæ¯”å¦‚ tcpNoDelay å’Œ keepAlive ã€‚è¯·å‚ç…§ ChannelOption API æ–‡æ¡£ä»¥åŠç‰¹å®šçš„ ChannelConfig å®žçŽ°ï¼Œä»¥èŽ·å¾—æœ‰å…³ ChannelOptionS æ”¯æŒçš„æ¦‚è¿°ã€‚ ä½ æœ‰æ³¨æ„åˆ° option() å’Œ childOption æ–¹æ³•äº†å—ï¼Ÿ option() æ˜¯ä¸º NioServerSocketChannel ç”¨æ¥æŽ¥æ”¶è¿›æ¥çš„è¿žæŽ¥ã€‚ childOption() æ˜¯ä¸ºè¢«çˆ¶é€šé“ ServerChannel æŽ¥æ”¶åˆ°çš„ ChannelS ï¼Œåœ¨æœ¬ä¾‹ä¸­æŒ‡çš„æ˜¯ NioServerSocketChannelã€‚ æˆ‘ä»¬çŽ°åœ¨å·²ç»å‡†å¤‡å¥½äº†ã€‚å‰©ä¸‹çš„å°±æ˜¯ç»‘å®šç«¯å£å’Œå¯åŠ¨æœåŠ¡äº†ã€‚åœ¨è¿™å„¿ï¼Œæˆ‘ä»¬ç»‘å®šäº†æœºå™¨æ‰€æœ‰ç½‘å¡çš„ 8080 ç«¯å£ã€‚ä½ çŽ°åœ¨å¯ä»¥è°ƒç”¨å¤šæ¬¡ bind() æ–¹æ³•ï¼ˆç”¨ä¸åŒçš„ç»‘å®šåœ°å€ï¼‰ã€‚ æ­å–œä½ ï¼ä½ å·²ç»åŸºäºŽ Netty å®Œæˆé‡Œä½ çš„ç¬¬ä¸€ä¸ªæœåŠ¡ç«¯ç¨‹åºã€‚ æŸ¥çœ‹æŽ¥æ”¶åˆ°çš„æ•°æ®Looking into the Received Data çŽ°åœ¨æˆ‘ä»¬å·²ç»å†™å¥½äº†æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæœåŠ¡ç«¯ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦æµ‹è¯•å®ƒæ˜¯å¦æ­£å¸¸è¿è¡Œã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ telnet å‘½ä»¤è¡Œã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥åœ¨ç»ˆç«¯è¾“å…¥ telnet localhost 8080 å‘½ä»¤è¡Œï¼Œç„¶åŽè¾“å…¥ä¸€äº›ä¸œè¥¿ã€‚ ä½†è¿™æ ·å°±èƒ½è¡¨ç¤ºæˆ‘ä»¬çš„æœåŠ¡è¿è¡Œæ­£å¸¸å—ï¼Ÿæˆ‘ä»¬å®žé™…ä¸Šå¹¶ä¸èƒ½å‡†ç¡®çŸ¥é“ï¼Œå› ä¸ºå®ƒæ˜¯ä¸ª discard æœåŠ¡ã€‚å®ƒå¹¶ä¸ä¼šè¿”å›žä»»ä½•ä¿¡æ¯ã€‚ä¸ºäº†è¯æ˜Žå®ƒæ˜¯çœŸçš„æ­£å¸¸è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸€ä¸‹æœåŠ¡ç«¯ç¨‹åºè®©å®ƒæŠŠæ”¶åˆ°çš„æ•°æ®æ‰“å°å‡ºæ¥ã€‚ æˆ‘ä»¬å·²ç»çŸ¥é“å½“æ•°æ®è¢«æŽ¥æ”¶åˆ°çš„æ—¶å€™ä¼šè°ƒç”¨ channelRead() æ–¹æ³•ã€‚å¯ä»¥åœ¨ DiscardServerHandler çš„ channelRead() æ–¹æ³•ä¸­åŠ ä¸€äº›ä»£ç ï¼š 123456789101112@Overridepublic void channelRead(ChannelHandlerContext ctx, Object msg) &#123; ByteBuf in = (ByteBuf) msg; try &#123; while (in.isReadable()) &#123; // (1) System.out.print((char) in.readByte()); System.out.flush(); &#125; &#125; finally &#123; ReferenceCountUtil.release(msg); // (2) &#125;&#125; è¿™ä¸ªä½Žæ•ˆçš„å¾ªçŽ¯å®žé™…ä¸Šå¯ä»¥æ›¿æ¢ä¸º: System.out.println(in.toString(io.netty.util.CharsetUtil.US_ASCII)) æˆ–è€…ï¼Œä½ å¯ä»¥åœ¨è¿™å„¿è°ƒ in.release() å¦‚æžœä½ å†æ¬¡è°ƒç”¨ telnet å‘½ä»¤ï¼Œä½ ä¼šçœ‹åˆ°æœåŠ¡ç«¯ç¨‹åºä¼šæŠŠæ”¶åˆ°çš„æ•°æ®æ‰“å°å‡ºæ¥ã€‚ discard æœåŠ¡çš„å…¨éƒ¨ä»£ç æ”¾åœ¨ io.netty.example.discard åŒ…ä¸­ã€‚ å†™ä¸€ä¸ª Echo æœåŠ¡ Writing an Echo Server ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„æœåŠ¡éƒ½æ˜¯æ¶ˆè´¹æ•°æ®ï¼Œè€Œä¸åšä»»ä½•å“åº”ã€‚ç„¶è€Œä½œä¸ºä¸€ä¸ªæœåŠ¡ï¼Œå¾€å¾€æ˜¯éœ€è¦å¯¹è¯·æ±‚åšå‡ºå“åº”çš„ã€‚è®©æˆ‘ä»¬å­¦ä¹ å¦‚ä½•é€šè¿‡å®žçŽ° ECHO åè®®ï¼ˆå¦‚è®ºæŽ¥æ”¶åˆ°ä»»ä½•æ•°æ®éƒ½åŽŸæ ·è¿”å›žï¼‰æ¥ç»™å®¢æˆ·ç«¯è¿”å›žå“åº”æ•°æ®ã€‚ ä¸Žæˆ‘ä»¬å…ˆå‰å°èŠ‚ä¸­å®žçŽ°çš„ discard æœåŠ¡å”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬å°†æŽ¥æ”¶åˆ°çš„æ•°æ®å‘å‡ºï¼Œè€Œä¸æ˜¯å°†å…¶æ‰“å°åˆ°æŽ§åˆ¶å°ã€‚å› æ­¤ï¼Œéœ€è¦å†æ¬¡æ”¹åŠ¨ channelRead() æ–¹æ³•ï¼š 12345@Overridepublic void channelRead(ChannelHandlerContext ctx, Object msg) &#123; ctx.write(msg); // (1) ctx.flush(); // (2)&#125; ChannelHandlerContext å¯¹è±¡æä¾›äº†å„ç§æ“ä½œå¯ä»¥ç”¨æ¥è§¦å‘å„ç§ I/O äº‹ä»¶ä»¥åŠæ“ä½œã€‚åœ¨è¿™å„¿æˆ‘ä»¬è°ƒç”¨ write(Object) æ–¹æ³•å°†æŽ¥æ”¶åˆ°çš„æ¶ˆæ¯ä¸€å­—ä¸å·®çš„è¿”å›žã€‚è¯·æ³¨æ„ï¼Œåœ¨è¿™å„¿æˆ‘ä»¬æ²¡æœ‰åƒ DISCARD æœåŠ¡ä¸€æ · release æŽ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œå› ä¸º Netty ä¼šåœ¨ä½ å°†å…¶å†™å‡ºè‡³ç½‘ç»œæ—¶å°†å…¶ releaseã€‚ ctx.write(Object) å¹¶ä¸ä¼šå°†æ¶ˆæ¯å†™åˆ°ç½‘ç»œä¸Šã€‚å®ƒåªæ˜¯è¢«æ”¾åœ¨å†…éƒ¨ç¼“å†²åŒºï¼Œç„¶åŽè¢« ctx.flush() æ–¹æ³•åˆ·æ–°è‡³ç½‘ç»œä¸Šã€‚æˆ–è€…ä½ å¯ä»¥ç”¨æ›´ç®€æ´çš„ ctx.writeAndFlush(msg) æ–¹æ³•ã€‚ å¦‚æžœä½ å†æ¬¡è¿è¡Œ telnet å‘½ä»¤ï¼Œä½ ä¼šå‘çŽ°æ— è®ºä½ å‘é€ä»€ä¹ˆå†…å®¹åˆ°æœåŠ¡å™¨ä¸Šï¼Œå®ƒéƒ½ä¼šå°†å…¶åŽŸæ ·è¿”å›žã€‚ echo æœåŠ¡çš„å…¨éƒ¨ä»£ç å¯ä»¥åœ¨ io.netty.example.echo åŒ…ä¸­æ‰¾åˆ°ã€‚ å†™ä¸€ä¸ªæ—¶é—´æœåŠ¡ Writing a Time Server æœ¬å°èŠ‚éœ€è¦å®žçŽ°çš„åè®®æ˜¯ TIME åè®®ã€‚ä¸Žä¹‹å‰ä¾‹å­ä¸åŒçš„æ˜¯ï¼Œå®ƒä¸ä¼šæŽ¥æ”¶ä»»ä½•è¯·æ±‚ï¼Œä¼šå‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œé‡Œé¢åŒ…å«äº†ä¸€ä¸ª 32 ä½æ•°å­—ï¼Œå½“æ¶ˆæ¯å‘é€ä¹‹åŽï¼Œä¼šå…³é—­è¿žæŽ¥ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œä½ å°†äº†è§£åˆ°å¦‚ä½•æž„é€ å¹¶å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶ä¸”åœ¨æœåŠ¡ç»“æŸçš„æ—¶å€™å…³é—­è¿žæŽ¥ã€‚ å› ä¸ºä½ ä¸æ‰“ç®—æŽ¥å—ä»»ä½•æ¶ˆæ¯ï¼Œè€Œè¿žæŽ¥ä¸€æ—¦å»ºç«‹ï¼Œä½ å°±ä¼šå°†æ¶ˆæ¯å‘å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™æ¬¡ä¸èƒ½ä½¿ç”¨ channelRead() æ–¹æ³•ã€‚æˆ‘ä»¬éœ€è¦é‡å†™ channelActive() æ–¹æ³•ã€‚ä»¥ä¸‹ä¸ºå®žçŽ°ï¼š 12345678910111213141516171819202122232425package io.netty.example.time;public class TimeServerHandler extends ChannelInboundHandlerAdapter &#123; @Override public void channelActive(final ChannelHandlerContext ctx) &#123; // (1) final ByteBuf time = ctx.alloc().buffer(4); // (2) time.writeInt((int) (System.currentTimeMillis() / 1000L + 2208988800L)); final ChannelFuture f = ctx.writeAndFlush(time); // (3) f.addListener(new ChannelFutureListener() &#123; @Override public void operationComplete(ChannelFuture future) &#123; assert f == future; ctx.close(); &#125; &#125;); // (4) &#125; @Override public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) &#123; cause.printStackTrace(); ctx.close(); &#125;&#125; è§£é‡Šä¸€ä¸‹ï¼Œ channelActive() æ–¹æ³•ä¼šåœ¨è¿žæŽ¥å»ºç«‹å¥½å¯ä»¥å‡†å¤‡äº¤æ¢æ•°æ®æ—¶è¢«è°ƒç”¨ã€‚æˆ‘ä»¬åœ¨è¿™å„¿å†™ä¸€ä¸ªå¯ä»¥è¡¨ç¤ºå½“å‰æ—¶é—´çš„ 32 ä½æ•°å­—ã€‚ ä¸ºäº†å‘é€ä¸€æ¡æ–°æ¶ˆæ¯ï¼Œæˆ‘ä»¬éœ€è¦åˆ†é…ä¸€ä¸ªæ–°çš„ç¼“å†²åŒº (buffer) ç”¨æ¥å­˜æ”¾æ¶ˆæ¯ã€‚æˆ‘ä»¬å°†è¦å†™ä¸€ä¸ª 32 ä½çš„æ•°å­—ï¼Œå› æ­¤ï¼Œéœ€è¦ä¸€ä¸ªå®¹é‡è‡³å°‘ä¸º 4 ä¸ªå­—èŠ‚çš„ ByteBuf ã€‚é€šè¿‡ ChannelHandlerContext.alloc() æ–¹æ³•èŽ·å–å½“å‰çš„ ByteBufAllocator å¯¹è±¡å¹¶ä¸”åˆ†é…ä¸€ä¸ªæ–°çš„ç¼“å†²åŒº (buffer)ã€‚ åƒå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä»¬å†™æž„é€ çš„æ•°æ®ã€‚ ä½†ç­‰ç­‰ï¼Œ flip æ–¹æ³•å‘¢ï¼Ÿ æˆ‘ä»¬åœ¨ NIO ä¸­å‘é€æ¶ˆæ¯ä¹‹å‰ä¸éœ€è¦è°ƒç”¨ java.nio.ByteBuffer.flip() æ–¹æ³•å—ï¼Ÿ ByteBuf æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºå®ƒæœ‰ä¸¤ä¸ªæŒ‡é’ˆ: ä¸€ä¸ªæ˜¯ç”¨æ¥è¯»æ“ä½œï¼Œå¦ä¸€ä¸ªæ˜¯ç”¨æ¥å†™æ“ä½œã€‚å½“ä½ å¾€ ByteBuf å†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œå†™æŒ‡é’ˆ(writer index)ä¼šå˜å¤§ï¼Œè€Œè¯»æŒ‡é’ˆ(reader index)æ²¡æœ‰å˜åŒ–ã€‚è¯»æŒ‡é’ˆ(reader index) å’Œ å†™æŒ‡é’ˆ(writer index) åˆ†åˆ«ä½“çŽ°äº†æ¶ˆæ¯çš„å¼€å§‹å’Œç»“å°¾ä½ç½®ã€‚ å¯¹æ¯” NIO ç¼“å†²åŒºï¼Œå…¶å¹¶æ²¡æœ‰æä¾›ä¸€ä¸ªæ¸…æ™°çš„æ–¹æ³•å¯ä»¥è®¡ç®—å‡ºæ¶ˆæ¯çš„å¼€å§‹å’Œç»“æŸä½ç½®ï¼Œé™¤äº†è°ƒç”¨ flip æ–¹æ³•ã€‚å½“ä½ å¿˜è®° flip ç¼“å†²åŒºæ—¶ï¼Œä½ ä¼šé‡åˆ°éº»çƒ¦ï¼Œå› ä¸ºæœ‰å¯èƒ½å‘ä¸å‡ºæ•°æ®æˆ–è€…å‘é”™æ•°æ®ã€‚è€Œè¿™æ ·çš„é”™è¯¯ä¸ä¼šåœ¨ Netty å‘ç”Ÿï¼Œå› ä¸ºé’ˆå¯¹ä¸åŒçš„æ“ä½œï¼Œæˆ‘ä»¬æœ‰ä¸åŒçš„æŒ‡é’ˆã€‚ä½ ä¼šå‘çŽ°ä¹ æƒ¯äº†æ²¡æœ‰ flipping out çš„ç”Ÿæ´»å˜å¾—æ›´ç®€å•ï¼ å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯, ChannelHandlerContext.write() (ä»¥åŠ writeAndFlush()) æ–¹æ³•è¿”å›žä¸€ä¸ª ChannelFuture å¯¹è±¡ã€‚ä¸€ä¸ª ChannelFuture å¯¹è±¡ä»£è¡¨ä¸€ä¸ª I/O æ“ä½œè¿˜æ²¡å‘ç”Ÿã€‚è¿™æ„å‘³ç€ä»»ä½•è¯·æ±‚æ“ä½œéƒ½æœ‰å¯èƒ½å°šæœªæ‰§è¡Œï¼Œå› ä¸º Netty ä¸­æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ã€‚æ¯”å¦‚ï¼Œå¦‚ä¸‹ä¾‹å­ä¸­ï¼Œæœ‰å¯èƒ½åœ¨æ¶ˆæ¯å‘å‡ºåŽ»ä¹‹å‰å…³é—­è¿žæŽ¥: 123Channel ch = ...;ch.writeAndFlush(message);ch.close(); å› æ­¤ä½ éœ€è¦åœ¨ write() æ–¹æ³•è¿”å›žçš„ ChannelFuture å¯¹è±¡å®Œæˆä¹‹åŽå…³é—­è¿žæŽ¥ï¼Œå½“å†™æ“ä½œå®ŒæˆåŽï¼Œå®ƒä¼šé€šçŸ¥å®ƒçš„ç›‘å¬ç¨‹åºã€‚è¯·æ³¨æ„ï¼Œclose() æ–¹æ³•ä¹Ÿæœ‰å¯èƒ½ä¸ä¼šç«‹å³å…³é—­è¿žæŽ¥ï¼Œä»–ä¹Ÿä¼šè¿”å›žä¸€ä¸ª ChannelFuture å¯¹è±¡ã€‚ å½“å†™è¯·æ±‚å®Œæˆæ—¶æˆ‘ä»¬å¦‚ä½•å¾—åˆ°é€šçŸ¥å‘¢? å¾ˆç®€å•ï¼Œåªéœ€è¦å¯¹è¿”å›žçš„ ChannelFuture æ·»åŠ  ChannelFutureListener å³å¯ã€‚åœ¨è¿™å„¿æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„åŒ¿åç±» ChannelFutureListener , å½“æ“ä½œå®Œæˆæ—¶å®ƒä¼šå…³é—­ Channelã€‚ è¦ä¸ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨é¢„å®šä¹‰çš„ç›‘å¬å™¨æ¥ç®€åŒ–ä½ çš„ä»£ç ï¼š 1f.addListener(ChannelFutureListener.CLOSE); å¯ä»¥ä½¿ç”¨ UNIX å‘½ä»¤ rdate æ¥æµ‹è¯•æˆ‘ä»¬çš„æ—¶é—´æœåŠ¡æ˜¯å¦èƒ½å¦‚é¢„æœŸå·¥ä½œï¼š 1$ rdate -o &lt;port&gt; -p &lt;host&gt; è¿™å„¿çš„ &lt;port&gt; æ˜¯åœ¨ main() æ–¹æ³•ä¸­æŒ‡å®šçš„ç«¯å£å·ï¼Œ&lt;host&gt; é€šå¸¸æ˜¯ localhost ã€‚ å†™ä¸€ä¸ªæ—¶é—´å®¢æˆ·ç«¯ Writing a Time Client ä¸æƒ³ DISCARD å’Œ ECHO æœåŠ¡ï¼Œ TIME æœåŠ¡éœ€è¦ä¸€ä¸ªå®¢æˆ·ç«¯ã€‚å› ä¸ºæ™®é€šäººå¾ˆéš¾å°† 32 ä¸ºäºŒè¿›åˆ¶æ•°æ®ç¿»è¯‘ä¸ºæ—¥åŽ†ä¸Šå¯¹åº”çš„æ—¶é—´ã€‚åœ¨æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ç¡®ä¿æœåŠ¡æ­£ç¡®çš„è¿è¡Œå¹¶ä¸”å­¦ä¹ å¦‚ä½•ç”¨ Netty å†™ä¸€ä¸ªå®¢æˆ·ç«¯ã€‚ Netty æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æœ€å¤§ä¹Ÿæ˜¯å”¯ä¸€çš„åŒºåˆ«å°±åœ¨äºŽä½¿ç”¨ä¸åŒçš„ bootstrap å’Œ Channel å®žçŽ°ã€‚è¯·æ³¨æ„è§‚å¯Ÿä»¥ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930package io.netty.example.time;public class TimeClient &#123; public static void main(String[] args) throws Exception &#123; String host = args[0]; int port = Integer.parseInt(args[1]); EventLoopGroup workerGroup = new NioEventLoopGroup(); try &#123; Bootstrap b = new Bootstrap(); // (1) b.group(workerGroup); // (2) b.channel(NioSocketChannel.class); // (3) b.option(ChannelOption.SO_KEEPALIVE, true); // (4) b.handler(new ChannelInitializer&lt;SocketChannel&gt;() &#123; @Override public void initChannel(SocketChannel ch) throws Exception &#123; ch.pipeline().addLast(new TimeClientHandler()); &#125; &#125;); // æ‰“å¼€å®¢æˆ·ç«¯ ChannelFuture f = b.connect(host, port).sync(); // (5) // ç­‰å¾…è¿žæŽ¥å…³é—­ f.channel().closeFuture().sync(); &#125; finally &#123; workerGroup.shutdownGracefully(); &#125; &#125;&#125; bootstrap ä¸Ž ServerBootstrap å¾ˆç±»ä¼¼ï¼Œé™¤äº†å®ƒä½¿ç”¨çš„æ˜¯éžæœåŠ¡ç«¯é€šé“ (non-server channels), å¦‚å®¢æˆ·ç«¯æˆ–è€…æ— è¿žæŽ¥é€šé“ã€‚ å¦‚æžœä½ åªæŒ‡å®šäº†ä¸€ä¸ª EventLoopGroup ï¼Œå®ƒå°†ä¼šæ—¢å½“ä½œ boss ç»„åˆä¼šå½“ä½œ worker ç»„ã€‚è™½ç„¶å®¢æˆ·ç«¯å¹¶ä¸ä½¿ç”¨ boss worker ã€‚ NioSocketChannel æ›¿æ¢ NioServerSocketChannel , ç”¨æ¥åˆ›å»ºå®¢æˆ·ç«¯çš„ Channel ã€‚ ç•™æ„æˆ‘ä»¬å¹¶æ²¡æœ‰åœ¨è¿™å„¿åƒ ServerBootstrap ä¸€æ ·ä½¿ç”¨ childOption() æ–¹æ³•ï¼Œå› ä¸ºå®¢æˆ·ç«¯çš„ SocketChannel æ²¡æœ‰çˆ¶ã€‚ ä¸ŽæœåŠ¡ç«¯è°ƒç”¨ bind() ä¸åŒï¼Œæˆ‘ä»¬åº”è¯¥åœ¨å®¢æˆ·ç«¯è°ƒç”¨ connect() æ–¹æ³•ã€‚ å¦‚ä½ æ‰€è§ï¼Œå®¢æˆ·ç«¯çš„ä»£ç å¹¶æ²¡æœ‰ä¸ŽæœåŠ¡ç«¯å·®å¤ªå¤šã€‚é‚£ä¹ˆ ChannelHandler è¯¥å¦‚ä½•å®žçŽ°å‘¢ï¼Ÿå®ƒåº”è¯¥ä»ŽæœåŠ¡ç«¯æŽ¥æ”¶åˆ° 32 ä¸ºçš„æ•´æ•°ï¼Œå°†å…¶ç¿»è¯‘ä¸ºäººç±»å¯è¯»çš„æ ¼å¼å¹¶å°†å…¶æ‰“å°å‡ºæ¥ï¼Œç„¶åŽå…³é—­è¿žæŽ¥ï¼š 1234567891011121314151617181920212223package io.netty.example.time;import java.util.Date;public class TimeClientHandler extends ChannelInboundHandlerAdapter &#123; @Override public void channelRead(ChannelHandlerContext ctx, Object msg) &#123; ByteBuf m = (ByteBuf) msg; // (1) try &#123; long currentTimeMillis = (m.readUnsignedInt() - 2208988800L) * 1000L; System.out.println(new Date(currentTimeMillis)); ctx.close(); &#125; finally &#123; m.release(); &#125; &#125; @Override public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) &#123; cause.printStackTrace(); ctx.close(); &#125;&#125; åœ¨ TCP/IP ä¸­ï¼ŒNetty å°†å‘é€æ¥çš„æ•°æ®è¯»åˆ° ByteBuf ä¸­ã€‚ çœ‹ä¸ŠåŽ»å¾ˆç®€å•ï¼Œå¹¶ä¸”æ²¡æœ‰å‘çŽ°ä»€ä¹ˆä¸ŽæœåŠ¡ç«¯ä¾‹å­ä¸­ä¸åŒçš„åœ°æ–¹ã€‚ç„¶è€Œï¼Œè¿™ä¸ªå¤„ç†å™¨æœ‰æ—¶å€™ä¼šå› ä¸ºå¼•å‘ IndexOutOfBoundsException å¼‚å¸¸ï¼Œè€Œæ‹’ç»å·¥ä½œã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€å°èŠ‚è®¨è®ºè¿™ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿã€‚ å¤„ç†åŸºäºŽæµçš„ä¼ è¾“ Dealing with a Stream-based Transport å¥—æŽ¥å­—ç¼“å†²åŒºçš„ä¸€ä¸ªå°å°æ³¨æ„äº‹é¡¹ One Small Caveat of Socket Buffer åœ¨åŸºäºŽæµä¼ è¾“ä¸­ï¼Œæ¯”å¦‚ TCP/IP ï¼Œ æŽ¥æ”¶åˆ°çš„æ•°æ®å­˜æ”¾åœ¨ä¸€ä¸ªå¥—æŽ¥å­—æŽ¥å—ç¼“å†²åŒº (socket receive buffer) ä¸­ã€‚å¯æƒœçš„æ˜¯ï¼ŒåŸºäºŽæµçš„ä¼ è¾“çš„ç¼“å†²åŒºæ˜¯ä¸€ä¸ªå­—èŠ‚é˜Ÿåˆ—ï¼Œè€Œä¸æ˜¯åŒ…é˜Ÿåˆ—ã€‚è¿™å°±æ„å‘³ç€ï¼Œå³ä½¿ä½ å‘äº†ä¸¤ä¸ªç‹¬ç«‹çš„æ•°æ®åŒ…ï¼Œæ“ä½œç³»ç»Ÿä¹Ÿä¸ä¼šé‚£å®ƒä»¬å½“ä¸¤æ¡æ¶ˆæ¯å¤„ç†ï¼Œè€Œåªæ˜¯å½“ä½œä¸€ä¸²æ•°ç»„ã€‚å› æ­¤ï¼Œè¿™ä¸èƒ½ä¿è¯ä½ è¯»åˆ°çš„æ•°æ®ç¡®å®žå°±æ˜¯ä½ è¿œç¨‹å†™å…¥çš„æ•°æ®ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å‡å®šæ“ä½œç³»ç»Ÿçš„ TCP/IP æ ˆæŽ¥æ”¶åˆ°ä¸‰ä¸ªåŒ…ï¼š å› ä¸ºåŸºäºŽæµçš„ä¼ è¾“åè®®çš„è¿™ä¸ªå±žæ€§ï¼Œåº”ç”¨ç¨‹åºè¯»åˆ°çš„æ•°æ®å¾ˆæœ‰å¯èƒ½æ˜¯è¿™æ ·çš„ç¢Žç‰‡: å› æ­¤ï¼Œæ— è®ºæ˜¯æœåŠ¡ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯ï¼Œåœ¨æŽ¥å—æ•°æ®çš„éƒ¨åˆ†ï¼Œåº”è¯¥å°†æ”¶åˆ°çš„æ•°æ®ç¢Žç‰‡æ•´ç†è¿›ä¸€ä¸ªæˆ–è€…å¤šä¸ªæœ‰æ„ä¹‰çš„å¸§ä¸­ï¼Œä»¥ä¾¿å¯ä»¥è¢«ç¨‹åºé€»è¾‘è½»æ¾ç†è§£ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒæŽ¥æ”¶åˆ°çš„æ•°æ®åº”è¯¥æ˜¯è¿™æ ·çš„å¸§ï¼š ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆ The First Solution çŽ°åœ¨è®©æˆ‘ä»¬å›žåˆ° TIME å®¢æˆ·å•çš„ä¾‹å­ä¸­ã€‚åœ¨è¿™å„¿æˆ‘ä»¬æœ‰åŒæ ·çš„é—®é¢˜ã€‚ä¸€ä¸ª 32 ä½çš„æ•´æ•°æ˜¯éžå¸¸å°æ•°æ®ï¼Œå®ƒç»å¸¸ä¸å¤ªå¯èƒ½è¢«æ‹†åˆ†ä¸ºç¢Žç‰‡ã€‚ä½†é—®é¢˜æ˜¯ï¼Œå®ƒæ˜¯æœ‰å¯èƒ½è¢«æ‹†åˆ†æˆç¢Žç‰‡çš„ï¼Œéšç€äº¤äº’æ¬¡æ•°çš„å¢žé•¿ï¼Œè¿™ç§å‡ çŽ‡ä¹Ÿéšä¹‹å¢žé•¿ã€‚ ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œåˆ›å»ºä¸€ä¸ªå†…éƒ¨ç´¯è®¡ç¼“å†²åŒºï¼Œç­‰å¾… 4 å­—èŠ‚å…¨éƒ¨è¢«æŽ¥æ”¶åˆ°å†…éƒ¨ç¼“å†²åŒºã€‚ä¸‹é¢çš„ä¿®æ”¹è¿‡çš„ TimeClientHandler å®žçŽ°è§£å†³äº†è¿™ä¸ªé—®é¢˜: 12345678910111213141516171819202122232425262728293031323334353637package io.netty.example.time;import java.util.Date;public class TimeClientHandler extends ChannelInboundHandlerAdapter &#123; private ByteBuf buf; @Override public void handlerAdded(ChannelHandlerContext ctx) &#123; buf = ctx.alloc().buffer(4); // (1) &#125; @Override public void handlerRemoved(ChannelHandlerContext ctx) &#123; buf.release(); // (1) buf = null; &#125; @Override public void channelRead(ChannelHandlerContext ctx, Object msg) &#123; ByteBuf m = (ByteBuf) msg; buf.writeBytes(m); // (2) m.release(); if (buf.readableBytes() &gt;= 4) &#123; // (3) long currentTimeMillis = (buf.readUnsignedInt() - 2208988800L) * 1000L; System.out.println(new Date(currentTimeMillis)); ctx.close(); &#125; &#125; @Override public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) &#123; cause.printStackTrace(); ctx.close(); &#125;&#125; ChannelHandler æœ‰ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸçš„ç›‘å¬æ–¹æ³•: handlerAdded() å’Œ handlerRemoved() ã€‚åªè¦ä¸é•¿æ—¶é—´é˜»å¡žï¼Œä½ å¯ä»¥æ‰§è¡Œä»»æ„çš„åˆå§‹åŒ–\åŽ»åˆå§‹åŒ–æ–¹æ³•ã€‚ é¦–å…ˆï¼ŒæŽ¥æ”¶åˆ°çš„æ•°æ®åº”è¯¥ç´¯è®¡åˆ°ç¼“å†²åŒºã€‚ ç„¶åŽï¼Œå¤„ç†å™¨å¿…é¡»æ£€æµ‹ç¼“å†²åŒºæ˜¯å¦æœ‰è¶³å¤Ÿçš„æ•°æ®ï¼Œæœ¬ä¾‹ä¸­æ˜¯ 4 ä¸ªå­—èŠ‚ï¼Œä¹‹åŽæ‰ä¼šå¤„ç†å®žé™…çš„ç¨‹åºä¸šåŠ¡é€»è¾‘ã€‚å¦åˆ™ï¼Œ Netty ä¼šåœ¨æœ‰æ›´å¤šæ•°æ®åˆ°æ¥æ—¶å†æ¬¡è°ƒç”¨ channelRead() æ–¹æ³•ï¼Œç›´åˆ°ç´¯è®¡åˆ°è¶³å¤Ÿ 4 ä¸ªå­—èŠ‚ã€‚ ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆ The Second Solution è™½ç„¶ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆè§£å†³äº† TIME å®¢æˆ·ç«¯çš„é—®é¢˜ï¼Œä¿®æ”¹è¿‡çš„å¤„ç†å™¨çœ‹ä¸ŠåŽ»å¹¶ä¸ç®€æ´ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªå¤æ‚çš„åè®®ï¼Œæ•°æ®ç”±å¤šä¸ªä¸å®šé•¿åº¦çš„å­—æ®µç»„æˆã€‚ä½ çš„ ChannelInboundHandler çš„å®žçŽ°ç«‹é©¬ä¼šå˜å¾—ä¸å¯ç»´æŠ¤ã€‚ å°±åƒä½ å·²ç»æ³¨æ„åˆ°çš„ï¼Œå¯ä»¥æ·»åŠ å¤šä¸ª ChannelHandler åˆ°ä¸€ä¸ª ChannelPipeline ï¼Œå› æ­¤ï¼Œä½ å¯ä»¥å°†ä¸€ä¸ªå¤§çš„ ChannelHandler æ‹†åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œä»¥é™ä½Žåº”ç”¨çš„å¤æ‚åº¦ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°† TimeClientHandler æ‹†åˆ†ä¸ºä¸¤ä¸ªå¤„ç†å™¨: TimeDecoder ç”¨æ¥å¤„ç†æ‹†åˆ†é—®é¢˜ï¼Œä»¥åŠ TimeClientHandler çš„åŽŸå§‹å®žçŽ°ã€‚ å¹¸è¿çš„æ˜¯ï¼Œ Netty æä¾›äº†ä¸€ä¸ªå¯è¢«ç»§æ‰¿çš„å¼€ç®±å³ç”¨çš„ç±»: 123456789101112package io.netty.example.time;public class TimeDecoder extends ByteToMessageDecoder &#123; // (1) @Override protected void decode(ChannelHandlerContext ctx, ByteBuf in, List&lt;Object&gt; out) &#123; // (2) if (in.readableBytes() &lt; 4) &#123; return; // (3) &#125; out.add(in.readBytes(4)); // (4) &#125;&#125; ByteToMessageDecoder æ˜¯ ChannelInboundHandler çš„ä¸€ä¸ªå®žçŽ°ç±»ï¼Œå¯ä»¥è®©å¤„ç†æ‹†åˆ†é—®é¢˜å˜å¾—ç®€å•ã€‚ å½“æ•°æ®è¢«æŽ¥æ”¶çš„æ—¶å€™ ByteToMessageDecoder è°ƒç”¨ decode() æ–¹æ³•æ¥å†…éƒ¨ç»´æŒç¼“å†²åŒºæ•°æ®ç´¯ç§¯ã€‚ ç´¯ç§¯ç¼“å†²åŒºæ•°æ®ç´¯ç§¯ä¸å¤Ÿå¤šçš„æ—¶å€™ï¼Œ decode() å¯ä»¥æ·»åŠ ä»»ä½•ä¸œè¥¿åˆ° out ã€‚æŽ¥æ”¶åˆ°æ›´å¤šçš„æ•°æ®æ—¶ï¼ŒByteToMessageDecoder ä¼šå†æ¬¡è°ƒç”¨ decode() æ–¹æ³•ã€‚ å¦‚æžœ decode() æ·»åŠ äº†ä¸ªå¯¹è±¡åˆ° out, è¯´æ˜Žè§£ç å™¨æˆåŠŸçš„è§£ç äº†æ¶ˆæ¯ã€‚ ByteToMessageDecoder ä¼šå°†ç´¯ç§¯ç¼“å†²åŒºä¸­å·²ç»è¯»è¿‡çš„æ•°æ®ä¸¢å¼ƒã€‚è®°ä½ï¼Œä½ ä¸éœ€è¦è§£ç å¤šæ¶ˆæ¯ï¼Œ ByteToMessageDecoder ä¼šåå¤è°ƒç”¨ decode() æ–¹æ³•ï¼Œç›´åˆ°å®ƒä¸æ·»åŠ ä»»ä½•å†…å®¹åˆ° outã€‚ çŽ°åœ¨æˆ‘ä»¬æœ‰å¦å¤–ä¸€ä¸ªå¤„ç†å™¨è¦æ·»åŠ åˆ° ChannelPipeline , æˆ‘ä»¬éœ€è¦ä¿®æ”¹ TimeClient ä¸­ ChannelInitializer çš„å®žçŽ°ï¼š 123456b.handler(new ChannelInitializer&lt;SocketChannel&gt;() &#123; @Override public void initChannel(SocketChannel ch) throws Exception &#123; ch.pipeline().addLast(new TimeDecoder(), new TimeClientHandler()); &#125;&#125;); å¦‚æžœä½ æ˜¯ä¸€ä¸ªå¤§èƒ†åˆ°ç”¨æˆ·ï¼Œå¯ä»¥å°è¯•ä¸‹æ›´ç®€å•çš„è§£ç å™¨ï¼ŒReplayingDecoder ã€‚å½“ç„¶äº†ï¼Œä½ éœ€è¦å‚è€ƒä¸‹ API æ–‡æ¡£ä»¥èŽ·å–æ›´å¤šä¿¡æ¯ã€‚ 1234567public class TimeDecoder extends ReplayingDecoder&lt;Void&gt; &#123; @Override protected void decode( ChannelHandlerContext ctx, ByteBuf in, List&lt;Object&gt; out) &#123; out.add(in.readBytes(4)); &#125;&#125; å¦å¤–ï¼ŒNetty æä¾›äº†å¾ˆå¤šå¼€ç®±å³ç”¨çš„è§£ç å™¨ä¾›ä½ å¯ä»¥å¾ˆç®€ç­”çš„å°±èƒ½å®žçŽ°å¤§å¤šæ•°åè®®ï¼Œé¿å…ä½ éœ€è¦å®žçŽ°ä¸€ä¸ªåºžå¤§çš„ä¸å¯ç»´æŠ¤çš„å¤„ç†å™¨ã€‚è¯·å‚è€ƒä¸‹é¢çš„åŒ…ä¸­çš„æ›´è¯¦ç»†çš„ä¾‹å­ï¼š io.netty.example.factorial , äºŒè¿›åˆ¶åè®®ï¼Œä»¥åŠ io.netty.example.telnet , åŸºäºŽæ–‡æœ¬è¡Œçš„åè®®ã€‚ ä½¿ç”¨ POJO æ›¿ä»£ ByteBuf Speaking in POJO instead of ByteBuf å›žé¡¾ç›®å‰æ‰€æœ‰çš„ä¾‹å­ï¼Œéƒ½æ˜¯ç”¨ ByteBuf ä½œä¸ºåè®®ä¸­æ¶ˆæ¯çš„ä¸»è¦æ•°æ®ç»“æž„ã€‚åœ¨æœ¬å°èŠ‚ï¼Œæˆ‘ä»¬å°†æ”¹å–„ TIME åè®®çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ï¼Œä½¿ç”¨ POJO æ›¿æ¢ ByteBuf ã€‚ åœ¨ ChannelHandler ä¸­ä½¿ç”¨ POJO çš„ä¼˜ç‚¹æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼›å°†ä»Ž ByteBuf ä¸­æå–ä¿¡æ¯éƒ¨åˆ†çš„ä»£ç ä»Žå¤„ç†å™¨ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå¯ä»¥è®©å¤„ç†å™¨å˜å¾—æ›´å¯ç»´æŠ¤ï¼Œå¯å¤ç”¨ã€‚åœ¨ TIME å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯è¯»å–ä¸€ä¸ª 32 ä½çš„æ•´æ•°ï¼Œç›´æŽ¥ç”¨ ByteBuf ä¸ä¼šæ˜¯ä¸ªå¤§é—®é¢˜ã€‚ç„¶è€Œï¼Œä½ ä¼šå‘çŽ°ï¼Œåœ¨çŽ°å®žä¸­çš„åè®®ï¼Œå°†å…¶åˆ†ç¦»å¼€æ¥æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ŒUnixTimeã€‚ 12345678910111213141516171819202122232425package io.netty.example.time;import java.util.Date;public class UnixTime &#123; private final long value; public UnixTime() &#123; this(System.currentTimeMillis() / 1000L + 2208988800L); &#125; public UnixTime(long value) &#123; this.value = value; &#125; public long value() &#123; return value; &#125; @Override public String toString() &#123; return new Date((value() - 2208988800L) * 1000L).toString(); &#125;&#125; æˆ‘ä»¬ä¿®æ”¹ TimeDecoderï¼Œç”Ÿäº§ä¸€ä¸ª UnixTimeï¼Œæ›¿ä»£ ByteBuf ã€‚ 12345678@Overrideprotected void decode(ChannelHandlerContext ctx, ByteBuf in, List&lt;Object&gt; out) &#123; if (in.readableBytes() &lt; 4) &#123; return; &#125; out.add(new UnixTime(in.readUnsignedInt()));&#125; éšç€è§£ç å™¨çš„ä¿®æ”¹ï¼Œ TimeClientHandler ä¸å†ä½¿ç”¨ ByteBuf : 123456@Overridepublic void channelRead(ChannelHandlerContext ctx, Object msg) &#123; UnixTime m = (UnixTime) msg; System.out.println(m); ctx.close();&#125; æ˜¯ä¸æ˜¯ç®€å•ä¼˜é›…äº†å¾ˆå¤šï¼ŸæœåŠ¡ç«¯ç”¨åŒæ ·çš„æ–¹æ³•ä¿®æ”¹ã€‚é¦–å…ˆä¿®æ”¹ TimeServerHandler ï¼š 12345@Overridepublic void channelActive(ChannelHandlerContext ctx) &#123; ChannelFuture f = ctx.writeAndFlush(new UnixTime()); f.addListener(ChannelFutureListener.CLOSE);&#125; çŽ°åœ¨å”¯ä¸€ç¼ºä¹çš„éƒ¨åˆ†å°±æ˜¯ç¼–ç å™¨äº†ï¼Œå®žçŽ° ChannelOutboundHandler ï¼Œå°†ä¸€ä¸ª UnixTime å¯¹è±¡è½¬æ¢ä¸º ByteBuf ã€‚å†™ä¸€ä¸ªç¼–ç å™¨å¾ˆç®€å•ï¼Œå› ä¸ºç¼–ç æ¶ˆæ¯çš„æ—¶å€™ï¼Œä¸éœ€è¦å¤„ç†æ‹†åŒ…ç»„åŒ…çš„é—®é¢˜ã€‚ 1234567891011package io.netty.example.time;public class TimeEncoder extends ChannelOutboundHandlerAdapter &#123; @Override public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) &#123; UnixTime m = (UnixTime) msg; ByteBuf encoded = ctx.alloc().buffer(4); encoded.writeInt((int)m.value()); ctx.write(encoded, promise); // (1) &#125;&#125; æœ¬è¡Œä¸­æœ‰å‡ ä¸ªé‡è¦çš„äº‹æƒ…ã€‚ ç¬¬ä¸€ï¼Œé€šè¿‡ [ChannelPromise] , Netty å¯ä»¥æ ‡è®°å°†ç¼–ç è¿‡çš„æ¶ˆæ¯å†™å‡ºåŽ»çš„å¤±è´¥æˆ–è€…æˆåŠŸçŠ¶æ€ã€‚ ç¬¬äºŒï¼Œä¸éœ€è¦è°ƒç”¨ ctx.flush() ã€‚æœ‰ä¸€ä¸ªä¸“é—¨çš„å¤„ç†å™¨æ–¹æ³• void flush(ChannelHandlerContext ctx) ç”¨æ¥è¦†ç›– flush() æ“ä½œã€‚ æƒ³è¦æ›´ç®€å•ï¼Œä½ å¯ä»¥ä½¿ç”¨ MessageToByteEncoder : 123456public class TimeEncoder extends MessageToByteEncoder&lt;UnixTime&gt; &#123; @Override protected void encode(ChannelHandlerContext ctx, UnixTime msg, ByteBuf out) &#123; out.writeInt((int)msg.value()); &#125;&#125; æœ€åŽä¸€æ­¥æ˜¯åœ¨æœåŠ¡ç«¯å°† TimeEncoder æ”¾è¿› ChannelPipeline ,æ’åœ¨ TimeServerHandler ä¹‹å‰ã€‚è¿™åªæ˜¯ä¸€ä¸ªå¾®ä¸è¶³é“çš„å°å·¥ä½œäº†ã€‚ å…³é—­ä½ çš„åº”ç”¨ Shutting Down Your Application å…³é—­ä¸€ä¸ª Netty åº”ç”¨å¾ˆç®€å•ï¼Œé€šè¿‡ shutdownGracefully() æ–¹æ³•å°†ä½ åˆ›å»ºçš„æ‰€æœ‰ EventLoopGroup ã€‚å½“æ‰€æœ‰çš„ EventLoopGroup éƒ½å®Œå…¨å…³é—­ï¼Œå¹¶ä¸”ç›¸åº”ç¾¤ç»„ä¸­çš„ Channel éƒ½å·²ç»å…³é—­çš„æ—¶å€™ï¼Œå®ƒä¼šè¿”å›žä¸€ä¸ª Future å¯¹è±¡é€šçŸ¥ä½ ã€‚ æ€»ç»“ åœ¨æœ¬ç« ï¼Œæˆ‘ä»¬é€šè¿‡å±•ç¤ºå¦‚ä½•ç”¨ Netty ç¼–å†™ä¸€ä¸ªå®Œæ•´çš„ç½‘ç»œåº”ç”¨ï¼Œå¿«é€Ÿçš„æµè§ˆäº†ä¸€æ¬¡ Nettyã€‚ åœ¨æŽ¥ä¸‹æ¥çš„ç« èŠ‚é‡Œï¼Œæœ‰å…³äºŽ Netty çš„æ›´å¤šå‘ƒè¯¦ç»†ä¿¡æ¯ã€‚æˆ‘ä»¬ä¹Ÿé¼“åŠ±ä½ æµè§ˆ io.netty.example åŒ…ä¸­çš„ä¾‹å­ã€‚ ç¤¾åŒº éšæ—¶ç­‰å¾…è§£å†³ä½ çš„é—®é¢˜ï¼Œä¹Ÿä¸€ç›´æœŸå¾…ä½ çš„æƒ³æ³•å’Œåé¦ˆï¼Œæ”¹å–„ Netty å’Œæ–‡æ¡£ã€‚ å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ issue]]></content>
    </entry>

    
    <entry>
      <title><![CDATA[ä¸ºä»€ä¹ˆè¦é€ è½®å­]]></title>
      <url>%2F2017%2F03%2F06%2FWhy-did-I-create-an-ORM-framework-again%2F</url>
      <content type="text"><![CDATA[å½“æˆ‘åœ¨ oschina.net ä¸Šä»¥ java orm ä½œä¸ºå…³é”®è¯è¿›è¡Œæœç´¢çš„æ—¶å€™ï¼Œå…±æ‰¾åˆ°529æ¡ç»“æžœã€‚é‚£ä¹ˆæˆ‘ä¸ºä»€ä¹ˆè¿˜æ˜¯è¦å†™ ur-orm å‘¢ï¼Ÿ ä¸ŽDBäº¤äº’çš„æ—¶å€™ï¼Œåªæƒ³è°ƒç”¨ä¸€ä¸ªæ–¹æ³•å°±è¡Œäº† è™½ç„¶çœ‹ä¸ŠåŽ»ä¸å¤Ÿé«˜å¤§ä¸Šï¼Œä½†åœ¨ä»£ç é‡Œå†™sqlæ„Ÿè§‰å°±æ˜¯èˆ’æœå‘€ðŸ˜Œ ä¸ŽæŸ¥è¯¢çš„æ—¶å€™è¿”å›žä¸ªå¯¹è±¡ç”¨èµ·æ¥éåŽ†ï¼Œå½“ç„¶äº†ï¼Œè¿™ä¹Ÿæ˜¯ ORM æ¡†æž¶æœ€èµ·ç è¦å®žçŽ°çš„ è½»é‡çº§ï¼Œè½»é‡çº§ï¼Œè¿˜æ˜¯è½»é‡çº§ã€‚åœ¨å¤§å®¶éƒ½åœ¨è¯´è½»é‡çº§çš„æ—¶å€™ï¼Œè¦åšåˆ°çœŸæ­£ä½†è½»é‡çº§ï¼Œæ¢ORMçš„æ—¶å€™ï¼Œåªä¼šè§‰å¾—å½“å‰çš„ä»£ç ä¸å¤Ÿç”¨ï¼Œè€Œä¸æ˜¯å‘çŽ°å½“å‰çš„ä¸€å †é…ç½®ï¼Œä»£ç æ˜¯å¤šä½™çš„ï¼Œå¯¹å¦ä¸€ä¸ªæ¡†æž¶æ¥è¯´ã€‚å½“ç„¶äº†ï¼Œè¿™æœ‰ç‚¹å„¿åæ¿€ã€‚ é‡è¦çš„æ˜¯ï¼Œè¦å¯¹å‘³å„¿ã€‚ ç”¨äº†å¥½å¤šå¹´çš„ MyBatis äº†ï¼Œè‡³ä»Šè¿˜æ˜¯è§‰å¾—è¿™æ˜¯ä¸ªå¥½çš„æ¡†æž¶ï¼Œä½†å®žåœ¨ä¸æƒ³åœ¨é¡¹ç›®å¼€å§‹çš„æ—¶å€™å…ˆæ¥ä¸€æ‹–å®ƒçš„é…ç½®ï¼Œä¸ç®¡æ˜¯ resultMap è¿˜æ˜¯å…¶å®ƒã€‚ JPA è®© Java å¼€å‘æœ‰äº†ç‚¹å„¿æ•æ·çš„æ„æ€äº†ï¼Œä½†æœ‰æ—¶å€™å°è£…çš„å¤ªæ·±ï¼Œç”¨èµ·æ¥è®©äººä¸çŸ¥æ‰€æŽªã€‚ å½“ç„¶äº†ï¼Œè¿™ä¸ªè½®å­ï¼Œè¯´ä¸å®šå“ªå¤©ä¹Ÿä¼šå˜å¾—è®©äººåˆçˆ±åˆæ¨ã€‚ðŸ˜„]]></content>
    </entry>

    
    <entry>
      <title><![CDATA[è¦åšçš„äº‹æƒ…]]></title>
      <url>%2F2017%2F03%2F03%2FSomething-to-do%2F</url>
      <content type="text"><![CDATA[æœ‰å¾ˆå¤šäº‹æƒ…è¦åšï¼ŒæŠŠä»–ä»¬åˆ—ä¸‹æ¥ side project ur-orm å­¦ä¹  vue.js netty è‹±è¯­ è¯»ä¹¦ ä¸‰ä½“ javaè™šæ‹Ÿæœºè§„èŒƒ å“åº”å¼webè®¾è®¡ äº§å‡º gitç»ƒä¹ ä»£ç æäº¤ å­¦ä¹ ç¬”è®° ä¸ºä»€ä¹ˆè¦å­¦å‰ç«¯ ä½œä¸ºä¸€ä¸ªä¸€ç›´åœ¨å†™åŽæ®µä»£ç çš„äººï¼Œæœ‰ç€ä¸€é¢—äº§å“çš„â¤ï¸ï¼Œæƒ³è¦æŠŠè‡ªå·±çš„ideaå±•ç¤ºå‡ºæ¥å¯ä¸æ˜¯çœ‹ç€ terminal ä¸­åº”ç”¨å¯åŠ¨æˆåŠŸäº†å°±è¡Œäº†çš„ã€‚ æ—¶é—´è¿‡çš„å¾ˆå¿«ï¼Œ2017å¹´çš„1/6åˆæ²¡äº†]]></content>
    </entry>

    
    <entry>
      <title><![CDATA[Hexoéƒ¨ç½²ç¬”è®°]]></title>
      <url>%2F2017%2F03%2F01%2FHexo-deploy-note%2F</url>
      <content type="text"><![CDATA[ä¸»é¢˜é€‰æ‹© hexo-theme-apollo ç½‘ä¸Šæ‰¾äº†ä¸ªæ°´æ»´çš„å›¾æ ‡ï¼Œå¥½çœ‹ï¼Œä¸€ç‚¹ç‚¹å¯“æ„ã€‚ å¤šå®¢æˆ·ç«¯å†™æ–‡ç« çš„é—®é¢˜ hexo d æ‰§è¡ŒåŽ hexo å°† hexo g ç”Ÿæˆçš„ public æ–‡ä»¶å¤¹ä¸‹çš„é™æ€æ–‡ä»¶éƒ¨ç½²åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œå…¶å®ƒ hexo çŽ¯å¢ƒç›¸å…³çš„å†…å®¹åˆ™è¿˜åœ¨æœ¬æœºä¸Šï¼Œè¿™æ ·åŠ¿å¿…å¯¼è‡´ä¹‹å‰è¾›è‹¦è£…çš„ä¸€ç³»åˆ—æ’ä»¶ï¼Œä¸»é¢˜ä¹‹ç±»çš„ä¸œè¥¿æ²¡æœ‰åŠžæ³•åŒæ­¥åˆ°å…¶å®ƒæœºå™¨ä¸Šï¼Œæ›´æ¢ç”µè„‘æ˜¯ä»¶éº»çƒ¦äº‹ã€‚ æš‚ä¸”æƒ³åˆ°é›†ä¸­è§£å†³æ–¹æ¡ˆ ä½¿ç”¨ dropboxï¼ŒOneDriver ä¹‹ç±»çš„æ–‡ä»¶åŒæ­¥æœåŠ¡åŒæ­¥æºæ–‡ä»¶ å¦å¤–å»ºä¸€ä¸ªrepoåŒæ­¥æºæ–‡ä»¶ ç½‘ç»œä¸Šè¿˜æœ‰ä¸€ç§å°†æºæ–‡ä»¶æäº¤åˆ°æ–°åˆ†æ”¯çš„åšæ³• çœ‹äº†hexo init åŽçš„ blog_dir ,æ˜¾ç„¶ hexo å·²ç»è€ƒè™‘åˆ°è¿™æ–¹é¢çš„é—®é¢˜ï¼Œæ”¯æŒå°†æºæ–‡ä»¶æäº¤åˆ° git ä»“åº“ä¸­ï¼Œå› ä¸º .gitignore å·²ç»åˆå§‹åŒ–å¥½äº†ã€‚ ä½œä¸ºä¸€ä¸ªç¨å¾®æœ‰ç‚¹å„¿å¼ºè¿«ç—‡çš„ç‹®å­åº§ï¼Œå†³å®šé‡‡ç”¨æ–°å»ºåˆ†æ”¯çš„æ–¹æ³• 123456cd $blog_dirgit initgit add *git checkout -b $branch_namegit remote add origin git@github.com:xxxx/xxxx.github.io.gitgit push origin $branch_name:$branch_name éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ_config.yml ä¸­ deploy èŠ‚ç‚¹ä¸è¦æš´éœ²æ•æ„Ÿä¿¡æ¯ã€‚ åœ¨æ–°çš„å®¢æˆ·ç«¯ï¼Œåªéœ€è¦å°†ä»£ç cloneä¸‹æ¥ï¼Œcheckoutåˆ°ç›¸åº”åˆ†æ”¯ï¼Œnpm install -g hexo-cli,npm install ä¹‹åŽ new, generate, deploy å³å¯ å…³äºŽæºç çš„ç»´æŠ¤ï¼Œå¯ä»¥å°†å½“å‰ repo çš„ default branch è®¾ç½®ä¸ºæºç çš„åˆ†æ”¯ï¼Œä»¥æ–¹ä¾¿åŽç»­ç»´æŠ¤ã€‚]]></content>
    </entry>

    
  
  
</search>
